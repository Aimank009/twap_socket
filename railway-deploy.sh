#!/bin/bash

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ‰ GREAT SUCCESS! Code is on GitHub!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âœ… GitHub Repository: https://github.com/Aimank009/twap_socket"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸš‚ Now Let's Deploy to Railway!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Follow these SIMPLE steps:"
echo ""
echo "1ï¸âƒ£  Open Railway: https://railway.app/new"
echo ""
echo "2ï¸âƒ£  Click 'Deploy from GitHub repo'"
echo ""
echo "3ï¸âƒ£  Select: Aimank009/twap_socket"
echo ""
echo "4ï¸âƒ£  Railway will automatically:"
echo "    âœ… Detect Node.js project"
echo "    âœ… Install dependencies"
echo "    âœ… Start the server"
echo "    âœ… Give you a public URL"
echo ""
echo "5ï¸âƒ£  Wait 2-3 minutes for deployment"
echo ""
echo "6ï¸âƒ£  Get your URL from Railway dashboard"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
read -p "Press Enter to open Railway Dashboard..."
open "https://railway.app/new" 2>/dev/null || echo "Please visit: https://railway.app/new"
echo ""
echo "ğŸŒ Railway Dashboard opened in your browser"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ“‹ After Deployment is Complete:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Test your deployment:"
echo ""
read -p "Enter your Railway app URL (without https://): " railway_url

if [ -n "$railway_url" ]; then
    echo ""
    echo "ğŸ§ª Testing deployment at: https://$railway_url"
    echo ""
    
    echo "1. Health Check:"
    curl -s "https://$railway_url/" | jq '.' 2>/dev/null || curl -s "https://$railway_url/"
    
    echo ""
    echo "2. Current Price:"
    curl -s "https://$railway_url/api/price" | jq '.' 2>/dev/null || curl -s "https://$railway_url/api/price"
    
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "ğŸ‰ YOUR ENDPOINTS:"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "ğŸ¥ Health Check:"
    echo "   https://$railway_url/"
    echo ""
    echo "ğŸ’¹ Current Price API:"
    echo "   https://$railway_url/api/price"
    echo ""
    echo "ğŸ“¡ Price WebSocket:"
    echo "   wss://$railway_url/ws/prices"
    echo ""
    echo "ğŸ¯ Settlement WebSocket:"
    echo "   wss://$railway_url/ws/settlements"
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "ğŸ“ UPDATE YOUR MERCURY FRONTEND:"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "// In your frontend config:"
    echo "const TWAP_SOCKET_URL = 'wss://$railway_url';"
    echo ""
    echo "// Price feed:"
    echo "const priceWs = new WebSocket('\${TWAP_SOCKET_URL}/ws/prices');"
    echo ""
    echo "// Settlement feed:"
    echo "const settlementWs = new WebSocket('\${TWAP_SOCKET_URL}/ws/settlements');"
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "âœ… DEPLOYMENT COMPLETE! ğŸ‰"
    echo ""
fi
